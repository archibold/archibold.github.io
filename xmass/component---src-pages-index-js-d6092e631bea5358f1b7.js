(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{143:function(e,n,t){"use strict";t.r(n);var r=t(0),u=t.n(r),a=t(158);n.default=function(){return u.a.createElement(a.a,null,u.a.createElement("h1",null,"Landing"),u.a.createElement("p",null,"The Landing Page is open to everyone, even though the user isn't signed in."))}},151:function(e,n,t){"use strict";t.r(n),t.d(n,"graphql",function(){return p}),t.d(n,"StaticQueryContext",function(){return m}),t.d(n,"StaticQuery",function(){return h});var r=t(0),u=t.n(r),a=t(8),i=t.n(a),s=t(150),o=t.n(s);t.d(n,"Link",function(){return o.a}),t.d(n,"withPrefix",function(){return s.withPrefix}),t.d(n,"navigate",function(){return s.navigate}),t.d(n,"push",function(){return s.push}),t.d(n,"replace",function(){return s.replace}),t.d(n,"navigateTo",function(){return s.navigateTo});var c=t(35);t.d(n,"waitForRouteChange",function(){return c.c});var l=t(155),d=t.n(l);t.d(n,"PageRenderer",function(){return d.a});var f=t(36);t.d(n,"parsePath",function(){return f.a});var m=u.a.createContext({}),h=function(e){return u.a.createElement(m.Consumer,null,function(n){return e.data||n[e.query]&&n[e.query].data?(e.render||e.children)(e.data?e.data.data:n[e.query].data):u.a.createElement("div",null,"Loading (StaticQuery)")})};function p(){throw new Error("It appears like Gatsby is misconfigured. Gatsby related `graphql` calls are supposed to only be evaluated at compile time, and then compiled away,. Unfortunately, something went wrong and the query was left in the compiled code.\n\n.Unless your site has a complex or custom babel/Gatsby configuration this is likely a bug in Gatsby.")}h.propTypes={data:i.a.object,query:i.a.string.isRequired,render:i.a.func,children:i.a.func}},152:function(e,n,t){"use strict";var r={};t.r(r),t.d(r,"db",function(){return i}),t.d(r,"auth",function(){return s});var u={};t.r(u),t.d(u,"doCreateUserWithEmailAndPassword",function(){return d}),t.d(u,"doSignInWithEmailAndPassword",function(){return f}),t.d(u,"doSignOut",function(){return m}),t.d(u,"doPasswordReset",function(){return h}),t.d(u,"doPasswordUpdate",function(){return p}),t.d(u,"getUserId",function(){return v});var a={};t.r(a),t.d(a,"doCreateUser",function(){return g}),t.d(a,"onceGetUsers",function(){return E}),t.d(a,"createNewList",function(){return w}),t.d(a,"readLists",function(){return b}),t.d(a,"readList",function(){return L}),t.d(a,"joinList",function(){return U}),t.d(a,"changeListName",function(){return x}),t.d(a,"deleteUserFromList",function(){return P}),t.d(a,"draw",function(){return k});var i,s,o=t(160),c=t.n(o),l=(t(161),t(162),{apiKey:"AIzaSyAFXFlXKvVIK8EOJ8-c0Hr9pyVf8djOYZU",authDomain:"xmasspresent.firebaseapp.com",databaseURL:"https://xmasspresent.firebaseio.com",projectId:"xmasspresent",storageBucket:"xmasspresent.appspot.com",messagingSenderId:"111610268866"});c.a.apps.length||c.a.initializeApp(l),"undefined"!=typeof window&&(i=c.a.database(),s=c.a.auth());var d=function(e,n){return s.createUserWithEmailAndPassword(e,n)},f=function(e,n){return s.signInWithEmailAndPassword(e,n)},m=function(){return s.signOut()},h=function(e){return s.sendPasswordResetEmail(e)},p=function(e){return s.currentUser.updatePassword(e)},v=function(){return s.currentUser.uid},g=(t(81),t(80),t(51),t(163),t(52),t(164),t(165),t(25),t(79),t(53),t(82),function(e,n,t){return i.ref("users/"+e).set({username:n,email:t})}),E=function(){return i.ref("users").once("value")},w=function(e){var n,t=(n=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)})()+n()+n()+n()+n()+n()+n()+n(),r=s.currentUser.uid,u=s.currentUser.displayName+" ("+s.currentUser.email+")",a=[];return a.push(i.ref("lists/"+t).set({name:e,userList:[{userId:r,userName:u}]})),a.push(i.ref("users/"+r+"/lists").push({uid:t})),Promise.all(a).then(function(){return t})},y=function(e){return e?Object.keys(e).map(function(n){return Object.assign({},e[n],{index:n})}):[]},b=function(){var e=s.currentUser.uid;return i.ref("users/"+e+"/lists").once("value").then(function(e){return e.val()}).then(function(e){var n=[];return y(e).forEach(function(e){n.push(L(e.uid).then(function(n){return n.uid=e.uid,n}))}),Promise.all(n)}).then(function(e){return y(e)})},L=function(e){return i.ref("lists/"+e).once("value").then(function(e){var n=e.val();return n.userList=y(e.val().userList),n})},U=function(e){var n=s.currentUser.uid;console.log();var t=s.currentUser.displayName+" ("+s.currentUser.email+")",r=i.ref("lists/"+e+"/userList").push({userId:n,userName:t});return i.ref("users/"+n+"/lists").push({uid:e}),r},x=function(e,n){var t={};return t["lists/"+e+"/name"]=n,i.ref().update(t)},P=function(e,n,t){return i.ref("users/"+n+"/lists").once("value").then(function(t){y(t.val()).forEach(function(t){t.uid===e&&i.ref("users/"+n+"/lists/"+t.index).remove()})}),i.ref("lists/"+e+"/userList/"+t).remove()},k=function(e){return i.ref("lists/"+e).once("value").then(function(n){var t=y(n.val().userList),r={};return t.forEach(function(n,u){var a=t.filter(function(e){return e.index!==n.index&&!e.isPicked}),i=Math.floor(Math.random()*a.length);2===a.length&&u===t.length-2&&(i=a.length-1),t.forEach(function(e){e.index===a[i].index&&(e.isPicked=!0)}),n.userDraw=a[i].userName,s.currentUser.uid===n.userId&&(t.myDraw=a[i].userName),r["lists/"+e+"/userList/"+n.index+"/userDraw"]=a[i].userName,r["lists/"+e+"/userList/"+a[i].index+"/isPicked"]=!0}),r["lists/"+e+"/isDraw/"]=!0,t.isDraw=!0,i.ref().update(r)})};t.d(n,"a",function(){return u}),t.d(n,"b",function(){return a}),t.d(n,"c",function(){return r})},153:function(e,n,t){"use strict";var r=t(0),u=t.n(r).a.createContext(null);n.a=u},154:function(e,n,t){"use strict";t.d(n,"c",function(){return r}),t.d(n,"g",function(){return u}),t.d(n,"f",function(){return a}),t.d(n,"e",function(){return i}),t.d(n,"b",function(){return s}),t.d(n,"a",function(){return o}),t.d(n,"d",function(){return c});var r="/",u="/signup",a="/signin",i="/pw-forget",s="/home",o="/account",c="/list"},155:function(e,n,t){var r;e.exports=(r=t(157))&&r.default||r},156:function(e){e.exports={data:{site:{siteMetadata:{title:"Gatsby Firebase Authentication"}}}}},157:function(e,n,t){"use strict";t.r(n);var r=t(0),u=t.n(r),a=t(8),i=t.n(a),s=t(37),o=t(1),c=function(e){var n=e.location,t=o.default.getResourcesForPathname(n.pathname);return u.a.createElement(s.a,{location:n,pageResources:t})};c.propTypes={location:i.a.shape({pathname:i.a.string.isRequired}).isRequired},n.default=c},158:function(e,n,t){"use strict";var r=t(156),u=t(0),a=t.n(u),i=t(159),s=t.n(i),o=t(151),c=t(153),l=t(152),d=function(){return a.a.createElement("button",{type:"button",onClick:l.a.doSignOut},"Sign Out")},f=t(154),m=function(){return a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(o.Link,{to:f.c},"Landing")),a.a.createElement("li",null,a.a.createElement(o.Link,{to:f.b},"Home")),a.a.createElement("li",null,a.a.createElement(o.Link,{to:f.a},"Account")),a.a.createElement("li",null,a.a.createElement(d,null)))},h=function(){return a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(o.Link,{to:f.c},"Landing")),a.a.createElement("li",null,a.a.createElement(o.Link,{to:f.f},"Sign In")))},p=function(){return a.a.createElement(c.a.Consumer,null,function(e){return e?a.a.createElement(m,null):a.a.createElement(h,null)})},v=t(12),g=t.n(v);n.a=function(e){return function(n){function t(e){var t;return(t=n.call(this,e)||this).state={authUser:null},t}g()(t,n);var r=t.prototype;return r.componentDidMount=function(){var e=this;"undefined"!=typeof window&&l.c.auth.onAuthStateChanged(function(n){n?e.setState(function(){return{authUser:n}}):e.setState(function(){return{authUser:null}})})},r.render=function(){var n=this.state.authUser;return a.a.createElement(c.a.Provider,{value:n},a.a.createElement(e,this.props))},t}(a.a.Component)}(function(e){var n=e.children;return a.a.createElement(o.StaticQuery,{query:"3470870683",render:function(e){return a.a.createElement("div",null,a.a.createElement(s.a,{titleTemplate:"%s | "+e.site.siteMetadata.title,defaultTitle:e.site.siteMetadata.title}),a.a.createElement("div",{className:"app"},a.a.createElement(p,null),a.a.createElement("hr",null),n))},data:r})})}}]);
//# sourceMappingURL=component---src-pages-index-js-d6092e631bea5358f1b7.js.map