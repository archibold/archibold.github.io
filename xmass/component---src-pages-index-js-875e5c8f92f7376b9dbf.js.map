{"version":3,"sources":["webpack:///./src/pages/index.js","webpack:///./.cache/gatsby-browser-entry.js","webpack:///./src/firebase/firebase.js","webpack:///./src/firebase/auth.js","webpack:///./src/firebase/db.js","webpack:///./src/components/Session/AuthUserContext.js","webpack:///./src/constants/routes.js","webpack:///./.cache/public-page-renderer.js","webpack:///./.cache/public-page-renderer-prod.js","webpack:///./src/components/SignOut/index.js","webpack:///./src/components/Navigation/index.js","webpack:///./src/components/layout.js","webpack:///./src/components/Session/withAuthentication.js"],"names":["__webpack_exports__","default","react__WEBPACK_IMPORTED_MODULE_0___default","a","createElement","_components_layout__WEBPACK_IMPORTED_MODULE_1__","151","e","n","t","r","d","p","m","h","u","i","s","o","withPrefix","navigate","push","replace","navigateTo","c","l","f","StaticQueryContext","createContext","StaticQuery","props","Consumer","staticQueryData","data","query","render","children","graphql","Error","propTypes","prop_types__WEBPACK_IMPORTED_MODULE_1___default","object","string","isRequired","func","db","auth","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","index_cjs_default","apps","length","initializeApp","window","database","auth_doCreateUserWithEmailAndPassword","email","password","createUserWithEmailAndPassword","auth_doSignInWithEmailAndPassword","signInWithEmailAndPassword","auth_doSignOut","signOut","auth_doPasswordReset","sendPasswordResetEmail","auth_doPasswordUpdate","currentUser","updatePassword","auth_getUserId","uid","db_doCreateUser","id","username","ref","set","db_onceGetUsers","once","db_createNewList","name","S4","Math","random","toString","substring","userId","userName","displayName","listOfPromises","userList","Promise","all","then","fromObjectToList","Object","keys","map","key","assign","index","db_readLists","snapshot","val","forEach","list","db_readList","topush","newList","db_joinList","listId","console","log","db_changeListName","newName","updates","update","db_deleteUserFromList","userIndex","remove","db_draw","user","listToDraw","filter","userTofilter","isPicked","item","floor","it","userDraw","myDraw","isDraw","AuthUserContext","154","LANDING","SIGN_UP","SIGN_IN","PASSWORD_FORGET","HOME","ACCOUNT","LIST","155","module","exports","__webpack_require__","ProdPageRenderer","_ref","location","pageResources","_loader__WEBPACK_IMPORTED_MODULE_3__","getResourcesForPathname","pathname","_page_renderer__WEBPACK_IMPORTED_MODULE_2__","shape","158","SignOut","react_default","type","onClick","firebase","doSignOut","Navigation_NavigationAuth","gatsby_browser_entry","Link","to","routes","b","Navigation_NavigationNonAuth","components_Navigation","authUser","v","g","Component","_React$Component","WithAuthentication","_this","call","this","state","inheritsLoose_default","_proto","prototype","componentDidMount","_this2","onAuthStateChanged","setState","Provider","value","Session_withAuthentication","Helmet_default","titleTemplate","site","siteMetadata","title","defaultTitle","className","_3470870683"],"mappings":"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","file":"component---src-pages-index-js-875e5c8f92f7376b9dbf.js","sourcesContent":["import React from 'react';\nimport Layout from '../components/layout';\n\nconst LandingPage = () => (\n  <Layout>\n    <h1>Landing</h1>\n    <p>\n      The Landing Page is open to everyone, even though the user isn't signed\n      in.\n    </p>\n  </Layout>\n);\n\nexport default LandingPage;\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport Link, {\n  withPrefix,\n  navigate,\n  push,\n  replace,\n  navigateTo,\n} from \"gatsby-link\"\nimport { waitForRouteChange } from \"./wait-for-route-change\"\nimport PageRenderer from \"./public-page-renderer\"\nimport parsePath from \"./parse-path\"\n\nconst StaticQueryContext = React.createContext({})\n\nconst StaticQuery = props => (\n  <StaticQueryContext.Consumer>\n    {staticQueryData => {\n      if (\n        props.data ||\n        (staticQueryData[props.query] && staticQueryData[props.query].data)\n      ) {\n        return (props.render || props.children)(\n          props.data ? props.data.data : staticQueryData[props.query].data\n        )\n      } else {\n        return <div>Loading (StaticQuery)</div>\n      }\n    }}\n  </StaticQueryContext.Consumer>\n)\n\nStaticQuery.propTypes = {\n  data: PropTypes.object,\n  query: PropTypes.string.isRequired,\n  render: PropTypes.func,\n  children: PropTypes.func,\n}\n\nfunction graphql() {\n  throw new Error(\n    `It appears like Gatsby is misconfigured. Gatsby related \\`graphql\\` calls ` +\n      `are supposed to only be evaluated at compile time, and then compiled away,. ` +\n      `Unfortunately, something went wrong and the query was left in the compiled code.\\n\\n.` +\n      `Unless your site has a complex or custom babel/Gatsby configuration this is likely a bug in Gatsby.`\n  )\n}\n\nexport {\n  Link,\n  withPrefix,\n  graphql,\n  parsePath,\n  navigate,\n  push, // TODO replace for v3\n  replace, // TODO remove replace for v3\n  navigateTo, // TODO: remove navigateTo for v3\n  StaticQueryContext,\n  StaticQuery,\n  PageRenderer,\n  waitForRouteChange,\n}\n","import firebase from 'firebase/app';\nimport 'firebase/auth';\nimport 'firebase/database';\n\nconst prodConfig = {\n  apiKey: \"AIzaSyAFXFlXKvVIK8EOJ8-c0Hr9pyVf8djOYZU\",\n  authDomain: \"xmasspresent.firebaseapp.com\",\n  databaseURL: \"https://xmasspresent.firebaseio.com\",\n  projectId: \"xmasspresent\",\n  storageBucket: \"xmasspresent.appspot.com\",\n  messagingSenderId: \"111610268866\"\n};\n\nconst devConfig = {\n  apiKey: \"AIzaSyAFXFlXKvVIK8EOJ8-c0Hr9pyVf8djOYZU\",\n  authDomain: \"xmasspresent.firebaseapp.com\",\n  databaseURL: \"https://xmasspresent.firebaseio.com\",\n  projectId: \"xmasspresent\",\n  storageBucket: \"xmasspresent.appspot.com\",\n  messagingSenderId: \"111610268866\"\n};\n\nconst config = process.env.NODE_ENV === 'production' ? prodConfig : devConfig;\n\nif (!firebase.apps.length) {\n  firebase.initializeApp(config);\n}\n\nlet db, auth;\n\nif (typeof window !== 'undefined') {\n  // Gatsby build will fail otherwise\n  db = firebase.database();\n  auth = firebase.auth();\n}\n\nexport { db, auth };\n","import { auth } from './firebase';\n\n// Sign Up\nexport const doCreateUserWithEmailAndPassword = (email, password) =>\n  auth.createUserWithEmailAndPassword(email, password);\n\n// Sign In\nexport const doSignInWithEmailAndPassword = (email, password) =>\n  auth.signInWithEmailAndPassword(email, password);\n\n// Sign out\nexport const doSignOut = () => auth.signOut();\n\n// Password Reset\nexport const doPasswordReset = email => auth.sendPasswordResetEmail(email);\n\n// Password Change\nexport const doPasswordUpdate = password =>\n  auth.currentUser.updatePassword(password);\n\nexport const getUserId = () =>\n  auth.currentUser.uid;\n\n// export const getUser = (id) => {\n//   console.log(auth)\n//   return ''; //auth.getUser(id);\n// }\n","import { db, auth } from './firebase';\n\n// User API\n\nexport const doCreateUser = (id, username, email) =>\n  db.ref(`users/${id}`).set({\n    username,\n    email,\n  });\n\nexport const onceGetUsers = () => db.ref('users').once('value');\n\nexport const createNewList = (name) => {\n  const uid = guidGenerator();\n  const userId = auth.currentUser.uid;\n  const userName = `${auth.currentUser.displayName} (${auth.currentUser.email})`;;\n\n  let listOfPromises = [];\n\n  listOfPromises.push(db.ref('lists/'+ uid).set({\n    name: name,\n    userList: [{\n      userId: userId,\n      userName: userName\n    }]\n  }));\n\n  listOfPromises.push(db.ref(`users/${userId}/lists`).push({uid}));\n\n  return Promise.all(listOfPromises).then(() => uid);\n}\nfunction guidGenerator() {\n    var S4 = function() {\n       return (((1+Math.random())*0x10000)|0).toString(16).substring(1);\n    };\n    return (S4()+S4()+S4()+S4()+S4()+S4()+S4()+S4());\n}\n\nconst fromObjectToList = object =>\n  object\n    ? Object.keys(object).map(key => ({ ...object[key], index: key }))\n    : [];\n\nexport const readLists = () => {\n  const userId = auth.currentUser.uid;\n  return db.ref(`users/${userId}/lists`).once('value').then(snapshot => {\n    return snapshot.val();\n  }).then((snapshot) => {\n    let listOfPromises = [];\n    fromObjectToList(snapshot).forEach((list) => {\n      listOfPromises.push(readList(list.uid).then((topush) => {\n        topush.uid = list.uid;\n        return topush;\n      }))\n    })\n    return Promise.all(listOfPromises);\n  }).then(snapshot => {\n    return fromObjectToList(snapshot);\n  });\n}\n\nexport const readList = (id) => {\n  return db.ref(`lists/${id}`).once('value').then(snapshot => {\n    const newList = snapshot.val();\n    newList.userList = fromObjectToList(snapshot.val().userList);\n    return newList;\n  });\n}\n\nexport const joinList = (listId) => {\n  const userId = auth.currentUser.uid;\n  console.log();\n  const userName = `${auth.currentUser.displayName} (${auth.currentUser.email})`;\n\n  const newList = db.ref('lists/'+ listId + '/userList').push({\n    userId: userId,\n    userName: userName\n  });\n\n  db.ref(`users/${userId}/lists`).push({\n    uid: listId\n  });\n\n  return newList;\n}\n\n\nexport const changeListName = (id, newName) => {\n  var updates = {};\n  updates[`lists/${id}/name`] = newName;\n  return db.ref().update(updates);\n}\n\nexport const deleteUserFromList = (listId, userId, userIndex) => {\n  db.ref(`users/${userId}/lists`).once('value').then(snapshot => {\n    fromObjectToList(snapshot.val()).forEach((list) => {\n      if(list.uid === listId) {\n        db.ref(`users/${userId}/lists/${list.index}`).remove();\n      }\n    })\n  });\n  return db.ref(`lists/${listId}/userList/${userIndex}`).remove();\n}\n\nexport const draw = (listId) => {\n  // const currentUserId = auth.currentUser.uid;\n  return db.ref(`lists/${listId}`).once('value').then(snapshot => {\n    const userList = fromObjectToList(snapshot.val().userList);\n    var updates = {};\n    // console.log(userList)\n    //delete current user from lists\n    userList.forEach((user, index) => {\n      const listToDraw = userList.filter((userTofilter)=>{\n        //filter current user\n        return (userTofilter.index !== user.index) &&\n        //or is already picked\n        (!userTofilter.isPicked)\n      })\n\n      let item = Math.floor(Math.random()*listToDraw.length);\n\n      //one before the last one BUGFIX\n      if(listToDraw.length === 2 && index === userList.length -2) {\n        item = listToDraw.length - 1;\n      }\n\n      userList.forEach((it) => {\n        if(it.index === listToDraw[item].index) {\n          it.isPicked = true;\n        }\n      })\n\n      user.userDraw = listToDraw[item].userName\n\n      if(auth.currentUser.uid === user.userId) {\n        userList.myDraw = listToDraw[item].userName;\n      }\n\n      updates[`lists/${listId}/userList/${user.index}/userDraw`] = listToDraw[item].userName;\n      updates[`lists/${listId}/userList/${listToDraw[item].index}/isPicked`] = true;\n\n    })\n\n    updates[`lists/${listId}/isDraw/`] = true;\n    userList.isDraw = true;\n    return db.ref().update(updates);\n  });\n}\n","import React from 'react';\n\nconst AuthUserContext = React.createContext(null);\n\nexport default AuthUserContext;\n","export const LANDING = '/xmass';\nexport const SIGN_UP = '/xmass/signup';\nexport const SIGN_IN = '/xmass/signin';\nexport const PASSWORD_FORGET = '/xmass/pw-forget';\nexport const HOME = '/xmass/home';\nexport const ACCOUNT = '/xmass/account';\nexport const LIST = '/xmass/list';\n","const preferDefault = m => (m && m.default) || m\n\nif (process.env.BUILD_STAGE === `develop`) {\n  module.exports = preferDefault(require(`./public-page-renderer-dev`))\n} else if (process.env.BUILD_STAGE === `build-javascript`) {\n  module.exports = preferDefault(require(`./public-page-renderer-prod`))\n} else {\n  module.exports = () => null\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\n\nimport InternalPageRenderer from \"./page-renderer\"\nimport loader from \"./loader\"\n\nconst ProdPageRenderer = ({ location }) => {\n  const pageResources = loader.getResourcesForPathname(location.pathname)\n  return React.createElement(InternalPageRenderer, {\n    location,\n    pageResources,\n  })\n}\n\nProdPageRenderer.propTypes = {\n  location: PropTypes.shape({\n    pathname: PropTypes.string.isRequired,\n  }).isRequired,\n}\n\nexport default ProdPageRenderer\n","import React from 'react';\n\nimport { auth } from '../../firebase';\n\nconst SignOutButton = () => (\n  <button type=\"button\" onClick={auth.doSignOut}>\n    Sign Out\n  </button>\n);\n\nexport default SignOutButton;\n","import React from 'react';\nimport { Link } from 'gatsby';\n\nimport AuthUserContext from '../Session/AuthUserContext';\nimport SignOutButton from '../SignOut';\nimport * as routes from '../../constants/routes';\n\nconst Navigation = () => (\n  <AuthUserContext.Consumer>\n    {authUser => (authUser ? <NavigationAuth /> : <NavigationNonAuth />)}\n  </AuthUserContext.Consumer>\n);\n\nconst NavigationAuth = () => (\n  <ul>\n    <li>\n      <Link to={routes.LANDING}>Landing</Link>\n    </li>\n    <li>\n      <Link to={routes.HOME}>Home</Link>\n    </li>\n    <li>\n      <Link to={routes.ACCOUNT}>Account</Link>\n    </li>\n    <li>\n      <SignOutButton />\n    </li>\n  </ul>\n);\n\nconst NavigationNonAuth = () => (\n  <ul>\n    <li>\n      <Link to={routes.LANDING}>Landing</Link>\n    </li>\n    <li>\n      <Link to={routes.SIGN_IN}>Sign In</Link>\n    </li>\n  </ul>\n);\n\nexport default Navigation;\n","import React from 'react';\nimport Helmet from 'react-helmet';\nimport { StaticQuery, graphql } from 'gatsby';\n\nimport Navigation from './Navigation';\nimport withAuthentication from './Session/withAuthentication';\n\nconst Layout = ({ children }) => (\n  <StaticQuery\n    query={graphql`\n      query LayoutQuery {\n        site {\n          siteMetadata {\n            title\n          }\n        }\n      }\n    `}\n    render={data => (\n      <div>\n        <Helmet\n          titleTemplate={`%s | ${data.site.siteMetadata.title}`}\n          defaultTitle={data.site.siteMetadata.title}\n        />\n        <div className=\"app\">\n          <Navigation />\n          <hr />\n          {children}\n        </div>\n      </div>\n    )}\n  />\n);\n\nexport default withAuthentication(Layout);\n","import React from 'react';\n\nimport AuthUserContext from './AuthUserContext';\nimport { firebase } from '../../firebase';\n\nconst withAuthentication = Component =>\n  class WithAuthentication extends React.Component {\n    constructor(props) {\n      super(props);\n\n      this.state = {\n        authUser: null,\n      };\n    }\n\n    componentDidMount() {\n      if (typeof window !== 'undefined') {\n        firebase.auth.onAuthStateChanged(authUser => {\n          authUser\n            ? this.setState(() => ({ authUser }))\n            : this.setState(() => ({ authUser: null }));\n        });\n      }\n    }\n\n    render() {\n      const { authUser } = this.state;\n\n      return (\n        <AuthUserContext.Provider value={authUser}>\n          <Component {...this.props} />\n        </AuthUserContext.Provider>\n      );\n    }\n  };\n\nexport default withAuthentication;\n"],"sourceRoot":""}